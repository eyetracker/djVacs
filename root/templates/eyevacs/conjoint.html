{% extends 'eyevacs/0preview1650.html' %}
{% load staticfiles %}
{% block body %}
{% load i18n %}    
<!-- ################################################################# -->

    {% if starter %}
    <div class="question_title">Thank you for your choices, now indicate how likely it would be that you would choose the following alternatives from 0 (definitely reject) to 10 (definitely accept)?</div>
    {% else %}
    <div class="question_title">Indicate how likely it would be that you would choose the following alternative from 0 (definitely reject) to 10 (definitely accept)?</div>
    {% endif %}

<form action="{{ destination }}" method="post" >
{% csrf_token %}

<div style="padding-left:300px; padding-top:150px;" >

<table  >
  <tr class="tr_spacer_con">
  </tr>
  <tr>
    {# <td class="attr_spacer_con" {# class="dctd attr" #}
    {# ></td><td class="spacer"></td>  #}
    <td class="dctdcon attrcon"> Food Quality </td><td class="spacercon"></td>      
    <td class="dctdcon attrcon"> Customer service rating </td><td class="spacercon"></td>   
    <td class="dctdcon attrcon"> Type of building </td><td class="spacercon"></td>    
    <td class="dctdcon attrcon"> Sea view </td><td class="spacercon"></td>     
    <td class="dctdcon attrcon"> Price </td><td class="spacercon"></td>     
    <td class="dctdcon attrcon"> Room category </td><td class="spacercon"></td>
</tr>                                                                                     
<tr class="tr_spacer_con">                                                                    
</tr>                                                                                     
<tr>                                                                                      
    {# screen 1 #}
    {# <td class="dctdcon optioncon">{{ conjoint.spacer }} </td><td class="spacercon"></td>         #}
    <td class="dctdcon optioncon">{{ conjoint.food }}</td><td class="spacercon"></td>           
    <td class="dctdcon optioncon">{{ conjoint.service }}</td><td class="spacercon"></td>           
    <td class="dctdcon optioncon">{{ conjoint.building }}</td><td class="spacercon"></td>           
    <td class="dctdcon optioncon">{{ conjoint.seaview }}</td><td class="spacercon"></td>           
    <td class="dctdcon optioncon">{{ conjoint.price }}</td><td class="spacercon"></td>           
    <td class="dctdcon optioncon">{{ conjoint.room }}</td><td class="spacercon"></td>           
       </tr>                                                                                     
       <tr class="tr_spacer_con">                                                                    
       </tr>                                                                                     
</table>
</div>

<div style="height:150px"> </div>

{# ######################################################################## #}
<div style="padding-left:250px;">
<table  >
   <tr class="captionrow" >
        <td class=""> </td>
        <td class="caption_cell_white"><p class="caption right">{{ extracaption.left }}</p></td>
        <td class="caption_cell_grey"></td>
        <td class="caption_cell_white"> </td>
        <td class="caption_cell_grey"></td>
        <td class="caption_cell_white"></td>
        <td class="caption_cell_grey"></td>
        <td class="caption_cell_white"></td>
        <td class="caption_cell_grey"></td>
        <td class="caption_cell_white"></td>
        <td class="caption_cell_grey"></td>
        <td class="caption_cell_white"> <p class="caption left">{{ extracaption.right }}</p></td>
    </tr> 
    <tr class="questionrow" >
        <td class=""></td>
        <td class="cell_white right"> <label for="con{{ conjoint.id }}_1" ><input type="radio" name="conjoint" id="con{{ conjoint.id }}_1" value="0" /></label></td>
        <td class="cell_grey"> <label for="con{{ conjoint.id }}_2" ><input type="radio" name="conjoint" id="con{{ conjoint.id }}_2" value="1" /></label></td>
        <td class="cell_white"> <label for="con{{ conjoint.id }}_3" ><input type="radio" name="conjoint" id="con{{ conjoint.id }}_3" value="2" /></label></td>
        <td class="cell_grey"> <label for="con{{ conjoint.id }}_4" ><input type="radio" name="conjoint" id="con{{ conjoint.id }}_4" value="3" /></label></td>
        <td class="cell_white"> <label for="con{{ conjoint.id }}_5" ><input type="radio" name="conjoint" id="con{{ conjoint.id }}_5" value="4" /></label></td>
        <td class="cell_grey"> <label for="con{{ conjoint.id }}_6" ><input type="radio" name="conjoint" id="con{{ conjoint.id }}_6" value="5" /></label></td>
        <td class="cell_white"> <label for="con{{ conjoint.id }}_7" ><input type="radio" name="conjoint" id="con{{ conjoint.id }}_7" value="6" /></label></td>
        <td class="cell_grey"> <label for="con{{ conjoint.id }}_8" ><input type="radio" name="conjoint" id="con{{ conjoint.id }}_8" value="7" /></label></td>
        <td class="cell_white"> <label for="con{{ conjoint.id }}_9" ><input type="radio" name="conjoint" id="con{{ conjoint.id }}_9" value="8" /></label></td>           
        <td class="cell_grey"> <label for="con{{ conjoint.id }}_10" ><input type="radio" name="conjoint" id="con{{ conjoint.id }}_10" value="9" /></label></td>
        <td class="cell_white left"> <label for="con{{ conjoint.id }}_11" ><input type="radio" name="conjoint" id="con{{ conjoint.id }}_11" value="10" /></label></td>           
    </tr>
    <tr class="captionrow" >
        <td class=""> </td>
        <td class="caption_cell_white"></td>
        <td class="caption_cell_grey"></td>
        <td class="caption_cell_white"> </td>
        <td class="caption_cell_grey"></td>
        <td class="caption_cell_white"></td>
        <td class="caption_cell_grey"></td>
        <td class="caption_cell_white"></td>
        <td class="caption_cell_grey"></td>
        <td class="caption_cell_white"></td>
        <td class="caption_cell_grey"></td>
        <td class="caption_cell_white"></td>
    </tr>
{# ######################################################################## #}
 

    {# {% endif %} #}
  
</table>

   <input type="submit" class="weiter" name="{{ conjoint.id }}" value="{{ bt_label }}" >
{# 2 optionen zur auswahl eines angebots: #}
{# 1. 'buchen! button' (meine preference) #}
{# 2. javascript on click auf jede einzelne zelle... radio button der signalisiert oder gleich die farbe der ganzen row aendern. #}
{#  #}
{# kann bei 1. ein 'hover' einbauen, column wechselt farbe #}

</form>



{# ######################################################################## #}
<div class="debugtext"></div>

<script>
    $(this).ready(function(){
        {# both working #}
        {# $("input").change(function(){ #}
        $("form").click(function(){
            {# Highlight selected item #}
            var checkedRadio = $("input:checked");
            checkedRadio.each(function(i){
                itemID = $(this).attr("id");
                $("label[for="+itemID+"]").addClass("highlight");
                });
            {# revert others to default color  #}
            var unCheckedRadio = $("input:not(:checked)");
            unCheckedRadio.each(function(i){
                itemID = $(this).attr("id");
                $("label[for="+itemID+"]").removeClass("highlight");
                });
            });
        });
</script>
{# ######################################################################## #}
{% if DEBUG %} <div id="allErrors"></div> {% endif %}
<br/>
<br/>
<div style="margin-left:auto; margin-right:auto;width:500px;">
<div id="errorField" style="display:none" ></div>
</div>
<br/>
<br/>
{# <div id="errCont">You have missed out at least 1 Question!</div> #}
{% if validation %}
<script>
    $(this).ready(function(){
        window.log("{{validation}}");
        var thisform = $('form');
        window.log('validation is running...');
        var validator = thisform.validate({
            {# turn off debug to truly submit! #}
            debug: true,
            rules: {
                {# . und () {} sind nicht erlaubt in rules... #}
                {# $.each(questions, function(index, value ){ #}
                {#     value: "required", )}#}
                conjoint: "required",
                },
            {# only executed on form submit!!! hiding of off error #}
            {# has to be solved with another funtion, eg: errorContainer #}
            invalidHandler: function(thisform, validator) {
                var errors = validator.numberOfInvalids();
                window.log('errors:', errors)
                if (errors) {
                  var message = errors == 1
                  ? 'Missing'
                  : 'Missed ' + errors + ' fields.';
                $("#errorField").text('You have left ' + errors + ' questions unanswered!');
                {# $("div.arr span").text(message); #}
                $("#errorField").show();
                  } else {
                $("#errorField").hide();
                  }
              },
            messages: {
               conjoint: "You did not select an answer!", 
            },
                errorClass: "invalid",
            {# error destination id #}
            errorLabelContainer: "#allErrors",
            errorContainer: "#errorField",            
            {# wraps EVERY error inside wrapper: #}
            wrapper: "ul", 
            errorElement: "em",
            {# debug only #}
            submitHandler: function(thisform) { 
                {# alert("Submitted!")  #}
                // do other stuff for a valid form
                thisform.submit();
                {# {{ scale_name }}.submit(); #}
            }
        });
    });
  </script>
  {% endif %}  
  {# endif validation #}
{% endblock %}
